{% extends "account/layout/layout.html" %}
{% block layout_content %}
    <form class="form"
          action="{% url 'advisor-access-request' %}"
          method="post">
        {% csrf_token %}
        <fieldset class="fr-fieldset flex-column align-items-start">
            <h4 class="fr-mb-2w d-block size-20px">Précisez votre demande</h4>
            <h5 class="fr-text fr-mb-2v h5-rework">
                Territoire concerné<span class="form-mandatory-element">*</span>
            </h5>
            <p class="fr-text--sm fr-mb-2v description-help-text">
                Indiquez le territoire sur lequel vous souhaitez consulter les dossiers déposés sur UrbanVitaliz.
            </p>
            <div class="fr-fieldset__element modal-create-organization__yes fr-mb-0 fr-p-2w border-bottom w-100">
                <div class="fr-radio-group">
                    <input type="radio"
                           id="selectDepartments-no"
                           name="is_select_departments"
                           value="false"
                           {% if form.is_select_departments.value == 'false' %}checked{% endif %}>
                    <label class="fr-label fr-label-rework" for="selectDepartments-no">Toute la France</label>
                </div>
                {% if form.is_select_departments.errors %}
                    <div class="fr-error-text form-mandatory-element">
                        {{ form.is_select_departments.errors.0 }}
                    </div>
                {% endif %}
            </div>
            <div class="fr-fieldset__element fr-p-2w fr-mb-0 w-100">
                <div class="fr-radio-group">
                    <input type="radio"
                           id="selectDepartments-yes"
                           name="is_select_departments"
                           value="true"
                           {% if form.is_select_departments.value == 'true' %}checked{% endif %}>
                    <label class="fr-label fr-label-rework" for="selectDepartments-yes">Un ou plusieurs départements spécifiques</label>
                </div>
                <div class="fr-input-group fr-ml-4w"
                    x-data="{objectsToSelect: JSON.parse(document.getElementById('departmentsArray').textContent), selectedDepartments: []}"
                    @set-departments="selectedDepartments = $event.detail">
                    {% include "tools/contacts/multi_select.html" with placeholder="Cherchez et sélectionnez vos départements pour avoir accès aux dossiers" label="Sélectionnez-le(s) ci-dessous : " %}
                    <template x-for="dept in selectedDepartments" :key="dept">
                        <input type="hidden" name="departments" :value="dept">
                    </template>
                    {% if form.departments.errors %}
                        <div class="fr-error-text form-mandatory-element">
                            {{ form.departments.errors.0 }}
                        </div>
                    {% endif %}
                </div>
            </div>
            <div class="fr-fieldset__content">
                <div class="fr-input-group fr-mt-4v">
                    <label for="comment" class="fr-label h5-rework">{{ form.comment.label }} (facultatif)</label>
                    <helptext class="description-help-text">{{ form.comment.help_text }}</helptext>
                    <textarea name="comment" class="fr-input" id="comment" rows="3"></textarea>
                </div>
                <button class="fr-btn custom-login-button w-100" type="submit">Envoyer la demande</button>
            </div>
        </fieldset>
    </form>
{% endblock layout_content %}
