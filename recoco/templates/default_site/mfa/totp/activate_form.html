{% extends "mfa/totp/base.html" %}
{% load allauth i18n %}
{% block title %}
    {% translate "Activate Authenticator App" %}
{% endblock title %}
{% block og_title %}
    {% translate "Activate Authenticator App" %}
{% endblock og_title %}
{% block content %}
    <div class="fr-container fr-container--fluid fr-my-md-14v">
        <div class="fr-grid-row fr-grid-row-gutters fr-grid-row--center">
            <div class="fr-col-12 fr-col-md-8 fr-col-lg-6">
                <div class="fr-container fr-background-alt--grey fr-px-md-0 fr-py-10v fr-py-md-14v">
                    <div class="fr-grid-row fr-grid-row-gutters fr-grid-row--center">
                        <div class="fr-col-12 fr-col-md-9 fr-col-lg-8">
                            <h1>{% translate "Activate Authenticator App" %}</h1>
                            <p>
                                {% blocktranslate %}To protect your account with two-factor authentication, scan the QR code below with your authenticator app. Then, input the verification code generated by the app below.{% endblocktranslate %} Puis cliquer sur "Activer".
                            </p>
                            {% url 'mfa_activate_totp' as action_url %}
                            <form method="post" action="{{ action_url }}">
                                <img src="{{ totp_svg_data_uri }}"
                                     alt="{{ form.secret }}"
                                     tags="mfa,totp,qr" />
                                {% csrf_token %}
                                <div class="fr-input-group">
                                    <label for="authenticator_secret">{% translate "Authenticator secret" %}</label>
                                    <input class="fr-input"
                                           type="text"
                                           id="authenticator_secret"
                                           value="{{ form.secret }}"
                                           disabled />
                                    <small class="fr-hint-text">
                                        {% translate "You can store this secret and use it to reinstall your authenticator app at a later time." %}
                                    </small>
                                </div>
                                <div class="fr-input-group">
                                    {% for field in form %}
                                        <div class="fr-input-group">
                                            <label class="fr-label" for="{{ field.id_for_label }}">{{ field.label }}</label>
                                            <input class="fr-input"
                                                   type="{{ field.field.widget.input_type }}"
                                                   id="{{ field.id_for_label }}"
                                                   name="{{ field.name }}"
                                                   placeholder="{{ field.field.widget.attrs.placeholder }}"
                                                   {% if field.field.required %}required{% endif %}
                                                   {% if field.field.disabled %}disabled{% endif %} />
                                            {% if field.help_text %}<small class="fr-hint-text">{{ field.help_text }}</small>{% endif %}
                                        </div>
                                    {% endfor %}
                                </div>
                                <button type="submit" class="fr-btn fr-btn--primary">{% trans "Activate" %}</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock content %}
