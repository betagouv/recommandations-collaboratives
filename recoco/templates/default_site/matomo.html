<!-- Matomo -->
{% if matomo_url and matomo_site_id %}
<script>
  var _paq = window._paq = window._paq || [];
  _paq.push(['setCustomDimension', customDimensionId = 1, customDimensionValue = '{{ request.site.domain }}']);
  _paq.push(['setCustomDimension', customDimensionId = 2, customDimensionValue = '{{ matomo_user_roles }}']);
  _paq.push(['trackPageView']);
  _paq.push(['enableLinkTracking']);
  (function() {
    var u="{{ matomo_url }}";
    _paq.push(['setTrackerUrl', u+'matomo.php']);
    _paq.push(['setSiteId', '{{ matomo_site_id }}']);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    var h = d.createElement('script');
    h.async=true; h.src=u+'plugins/HeatmapSessionRecording/tracker.min.js'; s.parentNode.insertBefore(h,s);
  })();
</script>
{% else %}
<!-- Please set MATOMO_URL and MATOMO_SITE_ID in your settings -->
{% endif %}
<!-- End Matomo Code -->
