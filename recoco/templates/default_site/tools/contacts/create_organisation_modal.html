{% load sass_tags %}
{% block css %}
    <link href="{% sass_src 'css/tools/contact/create-organisation-modal.scss' %}"
          rel="stylesheet"
          type="text/css" />
{% endblock css %}
<div x-data="CreateOrganisation()"
     id="create-organisation-modal"
     class="modal-create-organisation d-none z-2">
    <div class="d-flex justify-content-between border-bottom-666 fr-p-3v modal-create-contact__block">
        <p class="fw-bold color-666 correct-p">CREER UNE ORGANISATION</p>
        <span class="fr-icon-close-line color-666 cursor-pointer"
              aria-hidden="true"
              @click="closeCreateOrganisationModal"></span>
    </div>
    <div class="fr-p-3v modal-create-organisation__block">
        {% comment %} x-data="SearchNationalGroup" {% endcomment %}
        <span class="modal-create-organisation__label">Nom de l'organisation</span><span class="color-important">*</span>
        <p class="modal-create-organisation__label-info grey-text">
            Préciser sa zone géographique éventuelle (ex : Cerema Occitanie)
        </p>
        <template x-if="verifNomOrga">
        </template>
        <input type="text" class="fr-input" x-model="organisationName" required>
    </div>
    <div class="fr-p-3v modal-create-organisation__block">
        <fieldset class="fr-fieldset fr-mb-0"
                  id="radio-hint"
                  aria-labelledby="radio-hint-legend radio-hint-messages">
            <legend class="fr-fieldset__legend--regular fr-fieldset__legend fw-700"
                    id="radio-hint-legend">
                Rattachement national
                <span class="fr-hint-text">Cette organisation est-elle rattachée à une structure-mère ou un réseau national ? Ex : le Cerema Occitanie se rattache à la structure Cerema.</span>
            </legend>
            <div class="fr-fieldset__element modal-create-organisation__yes fr-mb-0 fr-pb-2v">
                <div class="fr-radio-group">
                    <input type="radio" id="natGroup-yes" name="natGroup">
                    <label class="fr-label" for="natGroup-yes" @click="setGroupNatToTrue">Oui</label>
                </div>
                <template x-if="isGroupNat">
                    {% comment %} a remplacer par un composant search group nat {% endcomment %}
                    <div>
                        <span class="modal-create-organisation__label-info grey-text">Nom de la structure ou du réseau national :</span>
                        <div class="fr-search-bar" id="header-search" role="search">
                            <input type="search"
                                   class="fr-input"
                                   x-model="userInput"
                                   required
                                   @input.debounce="onSearchOrgaGroup">
                            <button class="fr-btn" title="Rechercher" @click="onSearch">Rechercher</button>
                        </div>
                        <div class="fr-menu menu-modal-correct-fr-menu position-relative border-radius-4px">
                            <div class="fr-menu__list specific-width-26rem border-radius-4px">
                                <div class="fr-menu__list specific-width-26rem overflow-auto specific-height border-radius-4px fr-mb-0">
                                    <template x-if="userInput.length > 0 && showOrgaGroupsresults && !isAnOrgaGroupSelected">
                                        <template class="fr-menu__item" x-for="group in orgaGroupsFound">
                                            <div class="fr-pt-1w fr-px-1w add-borders cursor-pointer"
                                                 @click="onSelectOrga(orga)">
                                                <span x-text="group.name"></span>
                                            </div>
                                        </template>
                                    </template>
                                    <template class="fr-menu__item"
                                              x-if="userInput.length > 0 && !isAnOrgaGroupSelected && !showOrgaGroupsresults">
                                        <div>
                                            <div class="fr-m-1w fr-p-3v specific-banner">
                                                <span class="text-style">Aucun résultat</span>
                                            </div>
                                            {% comment %} <div class="btn-create-orga fr-p-1w cursor-pointer" @click="openCreateOrganisationModal">
                                                <span class="fr-icon-add-line" aria-hidden="true"></span><span>Créer une nouvelle organisation</span>
                                            </div> {% endcomment %}
                                        </div>
                                    </template>
                                </div>
                                {% comment %} <template x-if="userInput.length > 0 && showOrgasresults && !isAnOrgaSelected">
                                    <div class="btn-create-orga fr-p-1w cursor-pointer" @click="openCreateOrganisationModal">
                                        <span class="fr-icon-add-line" aria-hidden="true"></span><span>Créer une nouvelle organisation</span>
                                    </div>
                                </template> {% endcomment %}
                            </div>
                        </div>
                    </div>
                </template>
            </div>
            <div class="fr-fieldset__element fr-pt-2v fr-mb-0">
                <div class="fr-radio-group">
                    <input type="radio" id="natGroup-no" name="natGroup">
                    <label class="fr-label" for="natGroup-no" @click="setGroupNatToFalse">Non</label>
                </div>
            </div>
            <div class="fr-messages-group"
                 id="natGroup-messages"
                 aria-live="assertive"></div>
        </fieldset>
    </div>
    <div class="fr-p-3v modal-create-organisation__block">
        <span class="modal-create-organisation__label">Départements</span>
        <select class="fr-select" x-model="organisationGroup" required>
            <option value="" disabled selected>Choisir un groupe national</option>
        </select>
    </div>
    <div class="fr-p-3v modal-create-organisation__block d-flex">
        <button class="fr-btn fr-btn--secondary fr-mr-3v w-100 justify-content-center"
                @click="closeCreateOrganisationModal()">Annuler</button>
        <button class="fr-btn w-100 justify-content-center"
                @click="createOrganisation">Créer l'organisation</button>
    </div>
</div>
