{% comment %}
Parameter Django:
    - node :
    {   'data':
            {
                'recommendation_id': 4242,
                'text': 'task text'
            },
        'position': 1,
        'type': 'recommendation'
    }
    - posted_by : user object
Parameter Alpine:
    - recommendation : recommendation object
{% endcomment %}
<template x-if="tasks.length > 0">
    <div x-data='{recommendation: null}'
         x-init="recommendation = getRecommendationById(node.recommendation_id)"
         class="task-item rounded-3 fr-my-2v">
        <template x-if="recommendation">
            <a :href="recommendation?.resource?.web_url"
               class="stretched-link"
               target="_blank"
               @click="trackOpenRessource">
                <div>
                    <p x-html="renderMarkdown(recommendation.content)"></p>
                    <div class="task-item__resource">
                        <template x-if="recommendation.topic">
                            <div class="task-item__topic"
                                 :style="{ '--color-topic': stringToColor(recommendation.topic?.name) }">
                                <span class="task-item__topic-icon"></span>
                                <p class="task-item__topic-name fr-mb-0"
                                   x-text="recommendation.topic?.name"></p>
                            </div>
                        </template>
                        <template x-if="recommendation.resource">
                            <h4 class="fr-link" x-text="recommendation.intent"></h4>
                        </template>
                        <template x-if="!recommendation.resource">
                            <h4 x-text="recommendation.intent"></h4>
                        </template>
                        <template x-if="recommendation.resource">
                            <p class="task-item__resource-subtitle fr-mt-1w fr-mb-0"
                               x-text="recommendation.resource.subtitle"></p>
                        </template>
                        {% include "conversations/messages/fragments/tasks_status_buttons_js.html" %}
                    </div>
                </div>
            </a>
        </template>
    </div>
</template>
