{% load static %}
{% load django_vite %}
{% load sass_tags %}
{% load projects_extra %}
{% load common_tags %}
{% block js %}
    {% vite_asset 'js/components/ClickToSeeUser.js' %}
{% endblock js %}
{% block css %}
    <link href="{% sass_src 'projects/css/fragments/owner/owner-details.scss' %}"
          rel="stylesheet"
          type="text/css">
{% endblock css %}
{% load phone_filters %}
{{ users_to_display|json_script:"usersToDisplay" }}
{% is_staff_for_current_site request.user as is_staff %}
{% is_admin_for_current_site request.user as is_admin %}
{% is_advisor_for_site request.user as is_site_advisor %}
{% firstof is_site_advisor advising as advise_on %}
<div x-data="ClickToSeeUser({{ project.owner.id }}, {{ request.user.id }},  {% if not is_staff and not is_admin and advise_on %}false {% else %} true{% endif %}, {{ project.id }}, JSON.parse(document.getElementById('usersToDisplay').textContent))">
    {% get_advising_position request.user project request.site as position %}
    <div class="fr-pt-1v fr-pb-3v fr-px-2w"
         x-show="!displayUser"
         x-transition.duration.10ms>
        <button class="fr-btn w-100 justify-content-center"
                @click='handleClickToSeeInfo()'
                data-cy="btn-overview-reveal-contact">Voir les coordonnées</button>
    </div>
    <div x-show="displayUser"
         x-transition.duration.300ms
         data-cy="container-revealed-contact">
        {% if project.owner %}
            <a class="d-flex align-items-center fr-mb-1v text-decoration-none a-specific-fontsize-14 specific-color-high-blue-france"
               href="mailto:{{ project.owner.email }}">
                <svg class="bi align-middle" width="18" height="18" fill="currentColor">
                    <use xlink:href="{% static 'svg/bootstrap-icons.svg'  %}#link-45deg" />
                </svg>
                &nbsp;
                {{ project.owner.email }}
            </a>
        {% endif %}
        {% if project.owner.profile.phone_no or project.phone %}
            <span class="d-flex align-items-center a-specific-fontsize-14 specific-color-high-blue-france">
                <svg class="bi align-middle fr-mr-2v"
                     width="15"
                     height="15"
                     fill="currentColor">
                    <use xlink:href="{% static 'svg/bootstrap-icons.svg'  %}#telephone" />
                </svg>
                <a class="text-decoration-none a-specific-fontsize-14 specific-color-high-blue-france"
                   href="tel:{{ project.owner.profile.phone_no }}">
                    {% if project.owner.profile.phone_no %}
                        {{ project.owner.profile.phone_no|format_phone }}
                    {% elif project.phone %}
                        {{ project.phone|format_phone }}
                    {% endif %}
                </a>
            </span>
        {% endif %}
    </div>
</div>
