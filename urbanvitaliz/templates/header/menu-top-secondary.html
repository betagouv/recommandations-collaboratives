{% load static %}

<ul class="list-unstyled mb-0 d-flex justify-content-center align-items-center" style="padding-left: 15px;">

    <!-- Dashboard -->
    {% if is_switchtender or is_administrating_project %}
        <li class="nav-item dropdown nav-item-admin" style="margin-right: 35px">
            <div class="btn-group">
                <a href="{% url 'projects-project-list' %}" class="nav-link link-dark {% if url_name == 'projects-project-list' %}active{% endif %}">
                    <span class="ms-1 align-middle">Tableau de Bord</span>
                </a>
            </div>
        </li>
    {% endif %}

    <!-- Projects -->
    {% if active_project %}
    <li style="margin-right: 35px">
        <div id="project-selector" class="nav-item">
                <div x-data="{ open: false }" x-on:click.outside="open = false" class="btn-group">
                    <span class="ms-1 align-middle">Projets</span>

                    {% if request.session.projects|length > 0 %}
                    <button x-on:click="open = !open" type="button" class="border-0 btn py-0 px-1">
                        <svg data-toggle="tooltip" data-placement="top" title="Notifications désactivées" class="align-middle bi" width="20px" height="20px" fill="currentColor" stroke="currentColor" style="padding: 3px;">
                            <use xlink:href="{% static 'svg/bootstrap-icons.svg' %}#chevron-down"/>
                        </svg>
                    </button>
                    <ul x-show="open" :class="{'show':open}" class="dropdown-menu py-0 mt-2 top-100" style="width: 20vw;">
                        <li class="list-group-item px-4 py-1 list-group-item-action dropdown-item border-0 border-bottom" style="background-color: #e4ecea;">
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-break text-truncate">
                                    <a class="stretched-link text-reset text-decoration-none" href="{% url 'projects-project-detail' active_project.pk %}">{{ active_project.name|truncatechars:12|capfirst }}</a>
                                </span>
                                {% if active_project.muted %} 
                                    <svg data-toggle="tooltip" data-placement="top" title="Notifications désactivées" class="align-middle bi bg-warning rounded-circle" width="20px" height="20px" fill="currentColor" style="padding: 3px;">
                                        <use xlink:href="{% static 'svg/bootstrap-icons.svg' %}#volume-mute"/>
                                    </svg>
                                {% endif %}
                            </div>
                            <span class="text-secondary small text-break text-truncate">{{ active_project.commune.name }} ({{ active_project.commune.department.code }})</span>
                        </li>
                        {% for project in request.session.projects %}
                        <li class="list-group-item px-4 py-1 list-group-item-action dropdown-item border-0 border-bottom">
                            <div class="d-flex justify-content-between align-items-center">
                                <span class="text-break text-truncate">
                                    <a class="stretched-link text-reset text-decoration-none" href="{% url "projects-project-detail" project.id %}">{{ project.name|truncatechars:12|capfirst }}</a>
                                </span>
                                {% if project.actions_open > 0 %}
                                <div>
                                    <span class="align-middle badge bg-primary rounded-pill">
                                        {{ project.actions_open }}
                                    </span>
                                </div>
                                {% endif %}
                            </div>
                            <span class="text-secondary small text-break text-truncate">{{ project.location|truncatechars:20|capfirst }}</span>
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>
    </li>
    {% endif %}
    <!-- Methodology -->
    <li style="margin-right: 35px">
        <div class="btn-group">
            <a href="{% url 'methodology' %}" class="nav-link link-dark">
                <span class="me-2 ms-1 align-middle">Méthodologie</span>
            </a>
        </div>
    </li>
    <!-- Ressources -->
    <li style="margin-right: 35px">
        <div x-data="{ open: false }" x-on:click.outside="open = false" class="btn-group d-flex justify-content-center align-items-center">
            <a href="{% url 'resources-resource-search' %}" class="nav-link link-dark {% if url_name == 'resources-resource-search' %}active{% endif %}">
                <span class="ms-1 align-middle">Ressources</span>
            </a>
            {% if user.is_staff %}
            <button x-on:click="open = !open" type="button" class="border-0 btn py-0 px-1">
                <svg data-toggle="tooltip" data-placement="top" title="Notifications désactivées" class="align-middle bi" width="20px" height="20px" fill="currentColor" stroke="currentColor" style="padding: 3px;">
                    <use xlink:href="{% static 'svg/bootstrap-icons.svg' %}#chevron-down"/>
                </svg>
            </button>
            <ul x-show="open" :class="{'show':open}" class="dropdown-menu py-0 mt-2 top-100">
                <li><a class="dropdown-item px-4 py-2" href="{% url 'resources-resource-create' %}">Créer</a></li>
            </ul>
            {% endif %}
        </div>
    </li>
    <!-- Address Book -->
    {% if request.user.is_staff %}
    <li style="margin-right: 35px">
        <a href="{% url 'addressbook-organization-list' %}" class="nav-link link-dark {% if url_name == 'addressbook-organization-list' %}active{% endif %}">
            <span class="ms-1 me-2 align-middle">Carnet d'adresses</span>
        </a>
    </li>
    {% endif %}
</ul>

